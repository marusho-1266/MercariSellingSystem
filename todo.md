# メルカリ販売管理システム TODO リスト

## Phase 1: 基盤構築 🎀

### プロジェクト初期設定
- [x] プロジェクトのセットアップ
  - 詳細: GASプロジェクトの作成とGitHub連携
  - 依存関係: なし
  - 見積時間: 2時間
  - 優先度: 🔴
  - 完了: プロジェクト作成、デプロイ完了

- [x] 開発環境の構築
  - 詳細: claspの設定、ローカル開発環境の整備
  - 依存関係: プロジェクトセットアップ
  - 見積時間: 1時間
  - 優先度: 🔴
  - 完了: clasp設定、ファイル構成整備完了

### データベース設計
- [x] スプレッドシートの設計
  - 詳細: 
    - 商品マスタシート
    - 在庫管理シート
    - 販売管理シート
    - 財務管理シート
  - 依存関係: プロジェクト初期設定
  - 見積時間: 4時間
  - 優先度: 🔴
  - 完了: initialSetup関数で自動作成実装済み

### 基本CRUD操作の実装
- [x] 商品マスタCRUD
  - 詳細: 商品の登録・更新・削除・検索機能
  - 進捗: 登録・検索・更新・削除すべて実装済み
  - 依存関係: DB設計
  - 見積時間: 6時間
  - 優先度: 🔴

- [x] 在庫管理CRUD
  - 詳細: 在庫数・ステータスの管理機能
  - 進捗: 登録・検索・更新・削除すべて実装済み
  - 依存関係: 商品マスタCRUD
  - 見積時間: 4時間
  - 優先度: 🔴

## Phase 2: コア機能実装

### 在庫管理機能
- [x] 商品登録フォーム作成
  - 詳細: 商品情報入力UI実装、モーダル追加、GAS連携
  - 進捗: フロントエンド・GAS側連携ともに実装済み
  - 依存関係: 基本CRUD
  - 見積時間: 4時間
  - 優先度: 🔴

- [x] 在庫一覧機能
  - 詳細: 在庫管理シートの内容を一覧表示（商品マスタJOIN）、モーダルUI
  - 進捗: フロント・GASともに実装済み
  - 依存関係: 在庫管理CRUD
  - 見積時間: 3時間
  - 優先度: 🔴

- [x] 新規登録フロー
  - 詳細: 商品マスタ・在庫管理への新規登録（registerNewProduct）
  - 進捗: GAS側実装済み
  - 依存関係: 商品登録フォーム作成
  - 見積時間: 1時間
  - 優先度: 🟢

- [x] 出品登録フロー
  - 詳細: 在庫管理の在庫数減算・出品管理への追加（registerListing）
  - 進捗: GAS側実装済み
  - 依存関係: 新規登録フロー
  - 見積時間: 1時間
  - 優先度: 🟢

### 販売管理機能
- [x] 売上記録機能
  - 詳細: 販売情報の記録と更新、在庫連動
  - 進捗: GAS側実装済み
  - 依存関係: 在庫管理機能
  - 見積時間: 5時間
  - 優先度: 🔴

- [x] 取引ステータス管理
  - 詳細: 販売状況の追跡システム、在庫連動
  - 進捗: GAS側実装済み
  - 依存関係: 売上記録機能
  - 見積時間: 4時間
  - 優先度: 🔴

- [x] 販売一覧機能
  - 詳細: 販売管理シートの内容を一覧表示（商品マスタJOIN）、モーダルUI
  - 進捗: フロント・GASともに実装済み
  - 依存関係: 販売管理機能
  - 見積時間: 3時間
  - 優先度: 🔴

- [x] 販売登録フロー
  - 詳細: 出品管理の完了・販売管理への追加（registerSale）
  - 進捗: GAS側実装済み
  - 依存関係: 出品登録フロー
  - 見積時間: 1時間
  - 優先度: 🟢

## Phase 2.5: 出品管理機能 🆕

- [x] 出品管理シートのカラム設計
  - 詳細: 出品ID、商品ID、出品数、出品日、出品ステータス等を設計し@spreadsheet.mdに反映
  - 依存関係: 在庫管理シート設計
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] GAS: 出品登録関数の実装（registerListing等）
  - 詳細: 在庫から出品情報を登録し、在庫数を減算するGAS関数を実装
  - 依存関係: 出品管理シート設計
  - 見積時間: 2時間
  - 優先度: 🔴
  - 完了: 2025/05/05

- [x] GAS: 出品一覧取得関数の実装（getListingList等）
  - 詳細: 出品管理シートの内容を一覧取得するGAS関数を実装
  - 依存関係: 出品管理シート設計
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] index.html: 出品登録UIの実装
  - 詳細: 出品登録用のモーダルフォームを追加し、GAS関数と連携
  - 依存関係: GAS出品登録関数
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] index.html: 出品一覧UIの実装
  - 詳細: 出品管理シートの内容をテーブル表示するUIを追加
  - 依存関係: GAS出品一覧取得関数
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] UIとGASの連携テスト
  - 詳細: 出品登録・一覧の一連の動作をテストし、データ整合性を確認
  - 依存関係: 上記すべて
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/05

## Phase 2.6: 出品登録UIの選択肢改善 🆕

- [x] GAS: 出品可能な在庫一覧取得関数の実装（getListableInventory）
  - 詳細: 在庫管理シートから「ステータス＝出品可能」な商品ID・商品名を返すGAS関数を実装
  - 依存関係: 在庫管理シート設計
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] index.html: 出品登録モーダルの商品ID欄をselect化
  - 詳細: GASから取得した出品可能商品リストを選択肢として表示、商品ID＋商品名でUX向上
  - 依存関係: GAS: getListableInventory関数
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] submit時の値送信・バリデーション調整
  - 詳細: 選択した商品IDを正しく送信し、バリデーションもselect用に調整
  - 依存関係: 上記すべて
  - 見積時間: 0.5時間
  - 優先度: 🟢
  - 完了: 2025/05/05

- [x] テスト＆進捗反映
  - 詳細: UI・GAS連携の動作テスト、@todo.md進捗反映
  - 依存関係: 上記すべて
  - 見積時間: 0.5時間
  - 優先度: 🟢
  - 完了: 2025/05/05

## Phase 2.7: 仕入管理機能 🆕

- [x] 仕入管理シート設計・追加
  - 詳細: 仕入ID、商品ID、仕入日、仕入数、仕入価格、ステータス、備考のカラム設計とシート追加
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] GAS: registerPurchase（仕入登録）実装
  - 詳細: 仕入管理シートに履歴追加、在庫数加算、ステータス自動遷移
  - 見積時間: 2時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] GAS: updatePurchase（仕入更新）実装
  - 詳細: 仕入管理シートの該当行編集、在庫数調整
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] GAS: deletePurchase（仕入削除）実装
  - 詳細: 仕入管理シートの該当行削除、在庫数調整
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] GAS: getPurchaseList（仕入リスト取得）実装
  - 詳細: 仕入管理シートの履歴一覧取得
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] index.html: 仕入登録フォームUI実装
  - 詳細: 商品ID選択、仕入日、仕入数、仕入価格、備考の入力フォーム
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] index.html: 仕入リスト表示UI実装
  - 詳細: 仕入履歴テーブル表示
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] 仕入登録時の在庫数・ステータス自動連動
  - 詳細: 仕入登録・更新・削除時に在庫管理シートと連動
  - 見積時間: 1時間
  - 優先度: 🟢

- [x] バリデーション・エラーハンドリング実装
  - 詳細: 商品ID存在チェック、数値バリデーション、エラー表示
  - 見積時間: 1時間
  - 優先度: 🟢
  - 完了: 2025/05/06

- [x] テスト＆進捗反映
  - 詳細: 仕入管理機能の一連の動作テスト、@todo.md進捗反映
  - 見積時間: 1時間
  - 優先度: 🟢

- [x] 仕入一覧のステータス変更機能追加
  - 詳細: 仕入一覧テーブルのステータス列をselect化し、変更時にupdatePurchaseを呼び出してGAS側で更新。変更後はリストを再取得して即時反映。バリデーション・エラーハンドリングも実装。
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - サブタスク:
    - [x] UI: ステータス列をselect化
    - [x] JS: ステータス変更時にupdatePurchase呼び出し
    - [x] GAS: updatePurchaseのバリデーション再確認
    - [x] 変更後のリスト再取得・即時反映
    - [x] エラーハンドリング・テスト

## Phase 2.8: 動作確認時に発生した課題
- [x]  新規仕入登録のステータスの初期値変更
  - 詳細: 初期値を仕入中に変更
  - 優先度: 🟡
  - 完了: 2025/05/10

- [x]  仕入一覧のUI追加
  - 詳細: 商品名の表示を追加
  - 優先度: 🟢
  - 完了: 2025/05/10

- [x]  仕入登録の在庫管理への反映タイミング変更
  - 詳細: 仕入登録の情報を在庫管理に反映するタイミングをステータスが仕入中から完了になったときに変更する
  - 優先度: 🔴
  - 完了: 2025/05/07

- [x]  販売管理のステータス変更
  - 詳細: ステータスを（発送待ち、評価待ち、取引完了）
  - 優先度: 🟡
  - 完了: 2025/05/10

- [x]  新規販売登録のステータスの初期値変更
  - 詳細: 初期値を発送待ちに変更
  - 優先度: 🟡
  - 完了: 2025/05/10

- [x]  販売一覧のステータス変更機能追加
  - 優先度: 🔴
  - 完了: 2025/05/10

- [x]  ダッシュボード上の画面更新機能追加
  - 詳細: 各情報登録後にダッシュボードの値を更新する機能を追加
  - 優先度: 🟡
  - 完了: 2025/05/10

- [x]  UI変更
  - サブタスク
    - [x] ダッシュボード: 販売管理の前に出品管理を配置する
    - 優先度: 🟢
    - 完了: 2025/05/10

    - [x] 販売管理: 「販売登録」「販売一覧」の順に変更
    - 優先度: 🟢
    
- [x]  仕入一覧に表示するデータの絞り込み
  - 詳細: 仕入一覧に表示するデータをステータスが仕入中のもののみにする
  - 分類:機能強化  
  - 優先度: 🟢
  - 完了日: 2025/05/10

- [x]  在庫一覧・出品一覧・販売一覧にステータス絞り込み機能を追加
  - 詳細: 全一覧画面にステータスフィルターを追加して、選択したステータスで簡単に絞り込めるようにする
  - 分類:機能強化  
  - 優先度: 🟢
  - 完了日: 2025/05/10

## Phase 3: UI実装

### ダッシュボード
- [x] メインダッシュボード
  - 詳細: 重要指標の表示画面
  - 進捗: フロント・GASともに実装済み
  - 依存関係: コア機能実装
  - 見積時間: 8時間
  - 優先度: 🔴

- [ ] グラフ表示機能
  - 詳細: 売上・在庫推移のグラフ化
  - 依存関係: メインダッシュボード
  - 見積時間: 6時間
  - 優先度: 🟡

## Phase 4: 自動化・最適化

### 自動更新処理
- [x] 在庫自動更新
  - 詳細: 販売時の在庫数自動更新
  - 進捗: GAS側自動更新関数実装済み
  - 依存関係: 販売管理機能
  - 見積時間: 3時間
  - 優先度: 🟢

- [ ] 定期レポート生成
  - 詳細: 日次/週次レポートの自動生成
  - 依存関係: ダッシュボード
  - 見積時間: 4時間
  - 優先度: 🟢

## Phase 5: テストと改善

### テスト実装
- [ ] 単体テスト作成
  - 詳細: 各機能の単体テスト
  - 依存関係: 各機能実装
  - 見積時間: 8時間
  - 優先度: 🔴

- [ ] 結合テスト実施
  - 詳細: 機能間の連携テスト
  - 依存関係: 単体テスト
  - 見積時間: 6時間
  - 優先度: 🔴

### 最適化
- [ ] パフォーマンス改善
  - 詳細: 処理速度の最適化
  - 依存関係: テスト完了
  - 見積時間: 8時間
  - 優先度: 🟢

## Phase 2.9: 財務レポート機能 🆕

- [x] finance.gs ファイル作成と基本関数実装
  - 詳細: 財務レポート用のGASファイルを作成し、基本的な集計関数を実装
  - 見積時間: 2時間
  - 優先度: 🔴
  - サブタスク:
    - [x] getFinanceReport関数の実装（基本財務指標の集計）
    - [x] getPeriodSales関数の実装（期間別売上集計）
    - [x] getCategorySales関数の実装（カテゴリ別売上集計）
    - [x] getProductPerformance関数の実装（商品別パフォーマンス分析）

- [x] 財務レポートモーダルUI実装
  - 詳細: 財務レポート表示用のモーダルダイアログを作成
  - 依存関係: finance.gs基本関数実装
  - 見積時間: 2時間
  - 優先度: 🔴
  - サブタスク:
    - [x] モーダルの基本構造実装
    - [x] タブ切り替え機能の実装（基本指標、期間別、カテゴリ別、商品別）
    - [x] showFinance関数の拡張

- [x] Chart.js導入とグラフ表示実装
  - 詳細: Chart.jsライブラリを使用したグラフ表示機能の実装
  - 依存関係: 財務レポートモーダルUI実装
  - 見積時間: 3時間
  - 優先度: 🟡
  - サブタスク:
    - [x] Chart.jsの導入
    - [x] 売上・利益推移グラフの実装
    - [x] カテゴリ別売上円グラフの実装
    - [x] 商品パフォーマンスグラフの実装

- [x] 期間フィルタリング機能実装
  - 詳細: 日付範囲を指定して財務データをフィルタリングする機能
  - 依存関係: 財務レポートモーダルUI実装
  - 見積時間: 2時間
  - 優先度: 🟡
  - サブタスク:
    - [x] 日付選択UIの実装
    - [x] フィルタリングロジックの実装
    - [x] GAS側でのフィルタリング処理実装

- [x] データエクスポート機能実装
  - 詳細: 財務レポートデータをCSV形式でエクスポートする機能
  - 依存関係: 財務レポートモーダルUI実装
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - サブタスク:
    - [x] CSVデータ生成関数の実装
    - [x] ダウンロードボタンとロジックの実装

- [x] テストとデバッグ
  - 詳細: 財務レポート機能全体のテストとバグ修正
  - 依存関係: 上記すべて
  - 見積時間: 2時間
  - 優先度: 🔴
  - サブタスク:
    - [x] 各集計関数の動作確認
    - [x] UI表示の確認
    - [x] グラフ表示の確認
    - [x] フィルタリング機能の確認
    - [x] エクスポート機能の確認

### UI仕様統一・修正
- [x] 商品新規登録フォームのステータス選択肢を最新仕様（「出品可能」「仕入中」「在庫切れ」）に修正
  - 詳細: index.htmlのプルダウンをGAS側バリデーションと統一
  - 依存関係: 在庫管理CRUD, GAS側仕様
  - 見積時間: 0.5時間
  - 優先度: 🟢
  - 完了: 2024/06/10

- [x] index.html: 販売登録UIの実装
  - 詳細: 販売登録用のモーダルフォームを追加し、GAS関数（registerSale）と連携
  - 依存関係: GAS販売登録関数
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - サブタスク:
    - [x] 販売登録モーダルUI設計（出品ID選択、販売日、販売価格、手数料、送料、購入者情報、取引ステータス）
    - [x] "販売登録"ボタンを販売管理カードに追加
    - [x] showSaleRegisterForm, submitSaleRegister等のJS関数追加
    - [x] GAS registerSale関数との連携・バリデーション
    - [x ] UI・GAS連携テスト

- [x] index.html: 販売一覧UIの実装
  - 詳細: 販売管理シートの内容をテーブル表示するUIを追加し、GAS関数（getSalesList）と連携
  - 依存関係: GAS販売一覧取得関数
  - 見積時間: 1.5時間
  - 優先度: 🟢
  - 完了: 2024/06/10

- [ ] 進捗反映・タスク整理
  - 詳細: 完了タスクの[x]化、進行中タスクの[~]化、未着手タスクの[ ]化
  - 依存関係: 全タスク
  - 見積時間: 0.2時間
  - 優先度: 🟢 